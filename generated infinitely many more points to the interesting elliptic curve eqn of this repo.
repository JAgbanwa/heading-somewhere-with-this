# SageMath code to generate more rational points using the generators

# Define coefficients of original curve
a = 102516622445224071181618629075661543598435443927642055302797028500
b = 170288003150088713211165229564777675866712767658935950737783670400
c = 94287161519712324562577411784076704909304399983333523978591825920
d = 17402026102819032989296434839371590967156048128533655419095307484

# Calculate the shift used for Weierstrass form
shift = b / (3 * a)

# Define polynomial ring
Q = QQ
R.<X> = PolynomialRing(Q)

# Transform to Weierstrass form
x_sub = X - shift
rhs_transformed = a * x_sub^3 + b * x_sub^2 + c * x_sub + d
coeffs = rhs_transformed.list()

while len(coeffs) < 4:
    coeffs.append(0)

A_coeff = coeffs[1]
B_coeff = coeffs[0]

# Create the elliptic curve
E = EllipticCurve(Q, [A_coeff, B_coeff])

# Define the generators
P1 = E(1114/225, 638/3375)
P2 = E(1453/9, 55385/27)

print("=" * 80)
print("GENERATING RATIONAL POINTS ON THE ELLIPTIC CURVE")
print("=" * 80)
print()
print(f"Generator P1 = {P1}")
print(f"Generator P2 = {P2}")
print()

# Generate points using linear combinations: n1*P1 + n2*P2
print("Points of the form n1*P1 + n2*P2:")
print("=" * 80)
print()

points_generated = []

# Generate various combinations
for n1 in range(-2, 3):
    for n2 in range(-2, 3):
        if n1 == 0 and n2 == 0:
            continue  # Skip the point at infinity
        
        P = n1*P1 + n2*P2
        
        if not P.is_zero():  # Skip point at infinity
            X_coord = P[0]
            y_coord = P[1]
            
            # Convert back to original coordinates: x = X - shift
            x_coord = X_coord + shift
            
            points_generated.append((n1, n2, x_coord, y_coord))

# Sort by height (denominator size) for readability
points_generated.sort(key=lambda p: (p[2].denominator() * p[3].denominator()))

print(f"Generated {len(points_generated)} distinct points:")
print()

for i, (n1, n2, x_coord, y_coord) in enumerate(points_generated[:20]):  # Show first 20
    print(f"Point {i+1}: ({n1})*P1 + ({n2})*P2")
    print(f"  Original coords (x, y): ({x_coord}, {y_coord})")
    print(f"  Weierstrass coords (X, y): ({x_coord - shift}, {y_coord})")
    print()

if len(points_generated) > 20:
    print(f"... and {len(points_generated) - 20} more points")
    print()

print("=" * 80)
print("ADDITIONAL POINT GENERATION")
print("=" * 80)
print()

# Generate some specific interesting points
print("Some multiples of P1:")
for n in [1, 2, 3, 4, 5]:
    P = n * P1
    if not P.is_zero():
        x_coord = P[0] + shift
        print(f"  {n}*P1 = ({x_coord}, {P[1]})")

print()
print("Some multiples of P2:")
for n in [1, 2, 3, 4, 5]:
    P = n * P2
    if not P.is_zero():
        x_coord = P[0] + shift
        print(f"  {n}*P2 = ({x_coord}, {P[1]})")

print()
print("Some mixed combinations:")
interesting_combos = [(1, 1), (2, 1), (1, 2), (3, 1), (1, 3), (2, 2)]
for n1, n2 in interesting_combos:
    P = n1*P1 + n2*P2
    if not P.is_zero():
        x_coord = P[0] + shift
        print(f"  {n1}*P1 + {n2}*P2 = ({x_coord}, {P[1]})")

print()
print("=" * 80)
print("You can generate infinitely many rational points using combinations n1*P1 + n2*P2")
print("where n1, n2 are any integers!")
print("=" * 80)
